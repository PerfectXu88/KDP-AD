<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KDP: A Knowledge-Driven Diffusion Policy for End-to-End Autonomous Driving Based on Expert Routing</title>
    <script>
        // Set base URL for GitHub Pages
        if (window.location.hostname === 'perfectxu88.github.io' || window.location.pathname.indexOf('/KDP-AD') === 0) {
            document.write('<base href="/KDP-AD/">');
        }
    </script>
    <link rel="stylesheet" href="assets/css/style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar">
        <div class="nav-container">
            <div class="nav-brand">KDP-AD</div>
            <ul class="nav-menu">
                <li><a href="#home" class="nav-link">Home</a></li>
                <li><a href="#abstract" class="nav-link">Abstract</a></li>
                <li><a href="#method" class="nav-link">Method</a></li>
                <li><a href="#results" class="nav-link">Results</a></li>
                <li><a href="#case-study" class="nav-link">Case Study</a></li>
                <li><a href="#dataset" class="nav-link">Dataset</a></li>
                <!-- <li><a href="#code" class="nav-link">Code</a></li> -->
            </ul>
            <div class="hamburger">
                <span class="bar"></span>
                <span class="bar"></span>
                <span class="bar"></span>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <section id="home" class="hero">
        <div class="container">
            <div class="hero-content-vertical">
                <h1 class="hero-title">
<!--                    KDP: <span class="highlight">A Knowledge-Driven Diffusion Policy for End-to-End Autonomous Driving Based on Expert Routing</span>-->
                    KDP-AD:
                    <div class="highlight"> A Knowledge-Driven Diffusion Policy </div>
                    <div class="highlight">for End-to-End Autonomous Driving Based on Expert Routing</div>
                </h1>
                
                <div class="authors">
                    <p class="author-names">Chengkai Xu<sup>1</sup>, Jiaqi Liu<sup>2</sup>, Yicheng Guo<sup>1</sup>, Peng Hang<sup>1</sup>, Jian Sun<sup>1</sup></p>
                    <p class="affiliations">
                        <sup>1</sup>Tongji University, <sup>2</sup>UNC-Chapel Hill
                    </p>
                    <p class="contact-info">
                        <strong>Contact:</strong> 2534242@tongji.edu.cn
                    </p>
                </div>

                <div class="hero-image">
                    <img src="assets/images/Fig_framework.png" alt="KDP-AD Framework Overview" class="framework-img">
                </div>

                <div class="hero-buttons">
                    <a href="" class="btn btn-primary" target="_blank">
                        <i class="fas fa-file-pdf"></i> Paper
                    </a>
                    <a href="https://github.com/perfectxu88/KDP-AD" class="btn btn-secondary">
                        <i class="fab fa-github"></i> Code
                    </a>
                    <a href="#dataset" class="btn btn-secondary">
                        <i class="fas fa-database"></i> Dataset
                    </a>
                    <a href="#checkpoints" class="btn btn-secondary">
                        <i class="fa-solid fa-file"></i> CheckPoints
                    </a>
                </div>
            </div>
        </div>
    </section>

    <!-- Abstract Section -->
    <section id="abstract" class="section">
        <div class="container">
            <h2 class="section-title">Abstract</h2>
            <div class="abstract-content">
                <p>
                    End-to-end autonomous driving remains constrained by the need to generate multimodal actions, maintain temporal stability, and generalize across diverse scenarios. Existing methods often collapse multimodality, struggle with long-horizon consistency, or lack modular adaptability. This paper presents KDP, a knowledge-driven diffusion policy that integrates generative diffusion modeling with a sparse mixture-of-experts routing mechanism.
                </p>
                <p>
                   The diffusion component generates temporally coherent and multimodal action sequences, while the expert routing mechanism activates specialized and reusable experts according to context, enabling modular knowledge composition.
                </p>
                <p>
                    Extensive experiments across representative driving scenarios demonstrate that KDP achieves consistently higher success rates, reduced collision risk, and smoother control compared to prevailing paradigms. Ablation studies highlight the effectiveness of sparse expert activation and the Transformer backbone, and activation analyses reveal structured specialization and cross-scenario reuse of experts. These results establish diffusion with expert routing as a scalable and interpretable paradigm for knowledge-driven end-to-end autonomous driving.
                </p>
                <div class="key-contributions">
                    <h3>Key Contributions</h3>
                    <ul>
                        <li><span class="highlight">A knowledge-driven end-to-end driving framework.</span> We remodel experts in MoE as abstract driving knowledge units, enabling modular and compositional policy learning beyond task-centric formulations.</li>
                        <li>Integration of diffusion modeling with expert routing. We combine diffusion policies with MoE, which can maintain long-horizon consistency while adapting to diverse scenarios through modularity and selective reuse of knowledge.</li>
                        <li>Comprehensive empirical validation. We demonstrate the effectiveness of the proposed approach on diverse driving scenarios, achieving superior safety, generalization, and efficiency compared with baselines.</li>
                    </ul>
                </div>
            </div>
        </div>
    </section>

    <!-- Method Section -->
    <section id="method" class="section bg-light">
        <div class="container">
            <h2 class="section-title">Methodology</h2>
            <div class="method-overview">
                <div class="method-image">
                    <img src="assets/images/Fig_framework.png" alt="VIPER-R1 Framework" class="method-diagram">
                </div>
                <div class="method-description">
                    <p>
                        Framework of the proposed Knowledge-Driven Diffusion Policy. Scene inputs condition a diffusion-based policy to generate multi-modal, temporally coherent action sequences. A Mixture-of-Experts module refines these sequences by activating experts interpreted as abstract knowledge units, whose combinations express diverse and extensible driving skills such as interaction, maneuvering, and adaptation.
                    </p>
                </div>
            </div>

            <div class="method-stages">
                <!-- Stage 1: MSI -->
                <div class="stage">
                    <div class="stage-header">
                        <div class="stage-number">1</div>
                        <h3>Motion Structure Induction (MSI)</h3>
                    </div>
                    <div class="stage-content">
                        <div class="stage-steps">
                            <div class="step">
                                <h4>Step 1: Joint Induction</h4>
                                <p>Joint generation of Causal Chain of Thought (C-CoT) and initial Symbolic Ansatz from visual evidence and trajectory data.</p>
                                <div class="formula">
                                    L<sub>MSI-1</sub> = -ùîº<sub>(E,Y)~D<sub>phys</sub></sub> Œ£<sub>t=1</sub><sup>|Y|</sup> log œÄ<sub>Œ∏</sub>(y<sub>t</sub> | E, y<sub>&lt;t</sub>)
                                </div>
                            </div>
                            <div class="step">
                                <h4>Step 2: C-CoT-Guided Formulation</h4>
                                <p>Refines symbolic formulation by conditioning on ground-truth reasoning chain, focusing on syntax and semantics of physical formalisms.</p>
                                <div class="formula">
                                    L<sub>MSI-2</sub> = -ùîº<sub>(E,C,S)~D<sub>phys</sub></sub> Œ£<sub>t=1</sub><sup>|S|</sup> log œÄ<sub>Œ∏</sub>(s<sub>t</sub> | E, C, s<sub>&lt;t</sub>)
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Stage 2: RGSC -->
                <div class="stage">
                    <div class="stage-header">
                        <div class="stage-number">2</div>
                        <h3>Reward-Guided Symbolic Calibration (RGSC)</h3>
                    </div>
                    <div class="stage-content">
                        <p>
                            Uses Group Relative Policy Optimization (GRPO) to refine symbolic hypotheses through a sophisticated reward system:
                        </p>
                        <div class="reward-components">
                            <div class="reward-item">
                                <h4>Format Reward (R<sub>format</sub>)</h4>
                                <p>Ensures adherence to predefined template structure</p>
                            </div>
                            <div class="reward-item">
                                <h4>Structural Reward (R<sub>structural</sub>)</h4>
                                <p>Parameter-agnostic Jaccard similarity for topological correctness</p>
                            </div>
                            <div class="reward-item">
                                <h4>Accuracy Reward (R<sub>accuracy</sub>)</h4>
                                <p>Binary reward for exact symbolic matches</p>
                            </div>
                        </div>
                        <div class="formula">
                            R(S<sub>i</sub>) = w<sub>f</sub>R<sub>format</sub>(S<sub>i</sub>) + w<sub>s</sub>R<sub>structural</sub>(S<sub>i</sub>, S<sub>GT</sub>) + w<sub>a</sub>R<sub>accuracy</sub>(S<sub>i</sub>, S<sub>GT</sub>)
                        </div>
                    </div>
                </div>

                <!-- Stage 3: SR¬≤ -->
                <div class="stage">
                    <div class="stage-header">
                        <div class="stage-number">3</div>
                        <h3>Symbolic Residual Realignment (SR¬≤)</h3>
                    </div>
                    <div class="stage-content">
                        <p>
                            Agentic refinement process where VIPER-R1 invokes external symbolic regression tools to correct residual errors:
                        </p>
                        <div class="sr2-steps">
                            <div class="sr2-step">
                                <strong>Step 1:</strong> Calculate residual field: r(t) = a<sub>GT</sub>(t) - a<sub>VLM</sub>(x, v, t)
                            </div>
                            <div class="sr2-step">
                                <strong>Step 2:</strong> Apply symbolic regression: a<sub>residual</sub>(x, v, t) ‚Üê SR(x, v, t, r(t))
                            </div>
                            <div class="sr2-step">
                                <strong>Step 3:</strong> Theory realignment: a<sub>final</sub>(x, v, t) = a<sub>VLM</sub>(x, v, t) + a<sub>residual</sub>(x, v, t)
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Results Section -->
    <section id="results" class="section">
        <div class="container">
            <h2 class="section-title">Experimental Results</h2>
            
            <!-- Main Results -->
            <div class="results-section">
                <h3>Main Results</h3>
                <p>VIPER-R1 significantly outperforms state-of-the-art VLMs on the PhysSymbol benchmark:</p>
                
                <div class="results-grid">
                    <div class="result-card">
                        <div class="result-metric">
                            <span class="metric-value">0.812</span>
                            <span class="metric-label">Structural Score</span>
                        </div>
                        <p class="metric-description">56.7% improvement over best baseline (Claude-4-Sonnet)</p>
                    </div>
                    <div class="result-card">
                        <div class="result-metric">
                            <span class="metric-value">0.487</span>
                            <span class="metric-label">Accuracy Score</span>
                        </div>
                        <p class="metric-description">45.4% improvement over top zero-shot model</p>
                    </div>
                    <div class="result-card">
                        <div class="result-metric">
                            <span class="metric-value">0.032</span>
                            <span class="metric-label">Post-SR¬≤ MSE</span>
                        </div>
                        <p class="metric-description">3√ó lower error than best baseline (0.091)</p>
                    </div>
                </div>

                <div class="results-chart">
                    <img src="assets/images/Fig_main_performance.png" alt="Main Performance Results" class="chart-img">
                </div>
            </div>

            <!-- Comparison Chart -->
            <div class="results-section">
                <h3>Performance Comparison</h3>
                <div class="comparison-grid">
                    <div class="comparison-chart">
                        <img src="assets/images/Fig_bubble.png" alt="VLM Performance Bubble Chart" class="chart-img">
                        <p class="chart-caption">Performance comparison across different SOTA VLMs</p>
                    </div>
                </div>
            </div>

            <!-- Ablation Study -->
            <div class="results-section">
                <h3>Ablation Study</h3>
                <p>Each component of our framework contributes significantly to the overall performance:</p>
                <div class="ablation-grid">
                    <div class="ablation-chart">
                        <img src="assets/images/Fig_ablation.png" alt="Ablation Study Results" class="chart-img">
                        <p class="chart-caption">Contribution of MSI and RGSC stages</p>
                    </div>
                    <div class="ablation-results">
                        <div class="ablation-item">
                            <h4>Base Model (Qwen-VL-2.5)</h4>
                            <p>Structural: 0.096 | Accuracy: 0.179</p>
                        </div>
                        <div class="ablation-item">
                            <h4>+ MSI (SFT only)</h4>
                            <p>Structural: 0.554 | Accuracy: 0.399</p>
                            <span class="improvement">+475% structural improvement</span>
                        </div>
                        <div class="ablation-item">
                            <h4>+ MSI + RGSC (Full Model)</h4>
                            <p>Structural: 0.812 | Accuracy: 0.487</p>
                            <span class="improvement">+746% total improvement</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Case Study Section -->
    <section id="case-study" class="section">
        <div class="container">
            <h2 class="section-title">Case Study & Analysis</h2>
            
            <!-- Featured Case Study -->
            <div class="featured-case">
                <h3>Complex System: Non-linear Damping with Stochastic Noise</h3>
                <p>
                    We examine a challenging system governed by <code>a(t) = -kx - cv¬≥ + Œ∑(t)</code>, combining linear restoring force, 
                    non-linear damping, and stochastic noise. This case demonstrates VIPER-R1's ability to identify and integrate 
                    components with fundamentally different characteristics.
                </p>
                
                <div class="case-analysis-grid">
                    <div class="case-visualization">
                        <img src="assets/images/Fig_case1.png" alt="Complex System Analysis" class="case-img">
                        <p class="case-caption">Phase space and trajectory analysis of complex dynamical system</p>
                    </div>
                    
                    <div class="case-reasoning">
                        <h4><i class="fas fa-brain"></i> Chain-of-Thought Analysis</h4>
                        <div class="reasoning-steps">
                            <div class="step">
                                <h5>Visual Pattern Recognition</h5>
                                <ul>
                                    <li><strong>Oscillatory x(t):</strong> Linear restoring force (-k¬∑x)</li>
                                    <li><strong>Spiral structures in phase space:</strong> Non-linear damping (-c¬∑v¬≥)</li>
                                    <li><strong>Irregular fluctuations:</strong> Stochastic noise Œ∑(t)</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="equation-comparison">
                    <div class="equation-row">
                        <div class="equation-box">
                            <h5>Ground Truth</h5>
                            <div class="equation">a(t) = -1.542x - 2.766v¬≥ + 0.450Œ∑(t)</div>
                        </div>
                        <div class="equation-box">
                            <h5>VIPER-R1 Output</h5>
                            <div class="equation">a(t) = -1.454x - 2.834v¬≥ + 0.447Œ∑(t)</div>
                        </div>
                    </div>
                    <div class="accuracy-note">
                        <p><i class="fas fa-check-circle"></i> <strong>Remarkable Accuracy:</strong> The model correctly identifies all three physical components with high quantitative precision</p>
                    </div>
                </div>
            </div>

            <!-- Additional Cases Grid -->
            <div class="additional-cases">
                <h3>Additional Case Studies</h3>
                <div class="cases-grid">
                    <div class="case-item">
                        <img src="assets/images/analysis_1.png" alt="Damped Oscillator" class="case-thumb">
                        <div class="case-info">
                            <h4>Damped Oscillator</h4>
                            <p>Linear system with velocity damping</p>
                            <div class="case-equation">a = -kx - cv</div>
                        </div>
                    </div>
                    
                    <div class="case-item">
                        <img src="assets/images/analysis_2.png" alt="Driven System" class="case-thumb">
                        <div class="case-info">
                            <h4>Driven System</h4>
                            <p>Periodic external forcing</p>
                            <div class="case-equation">a = -kx + F‚ÇÄcos(œât)</div>
                        </div>
                    </div>
                    
                    <div class="case-item">
                        <img src="assets/images/analysis_3.png" alt="Non-linear Dynamics" class="case-thumb">
                        <div class="case-info">
                            <h4>Non-linear Potential</h4>
                            <p>Cubic restoring force</p>
                            <div class="case-equation">a = -kx - Œ±x¬≥</div>
                        </div>
                    </div>
                    
                    <div class="case-item">
                        <img src="assets/images/analysis_4.png" alt="Multi-frequency System" class="case-thumb">
                        <div class="case-info">
                            <h4>Multi-scale Dynamics</h4>
                            <p>Multiple time scales</p>
                            <div class="case-equation">a = -k‚ÇÅx - k‚ÇÇx cos(œât)</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Dataset Section -->
    <section id="dataset" class="section bg-light">
        <div class="container">
            <h2 class="section-title">PhysSymbol Dataset</h2>
            <div class="dataset-overview">
                <div class="dataset-description">
                    <p>
                        We introduce <strong>PhysSymbol</strong>, a comprehensive benchmark containing 5,000 multimodal instances for physics formula discovery. Each instance comprises:
                    </p>
                    <ul>
                        <li>Kinematic phase portraits (velocity vs. position)</li>
                        <li>Trajectory plots (position vs. time)</li>
                        <li>Numerical motion data (t, x(t), v(t), a(t))</li>
                        <li>Ground-truth symbolic equations</li>
                        <li>Chain-of-Thought reasoning explanations</li>
                    </ul>
                </div>
                <div class="dataset-stats">
                    <div class="stat-item">
                        <span class="stat-number">5,000</span>
                        <span class="stat-label">Total Instances</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-number">11</span>
                        <span class="stat-label">Physics Term Types</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-number">2</span>
                        <span class="stat-label">Visualization Types</span>
                    </div>
                </div>
            </div>
            
            <div class="dataset-examples">
                <h3>Sample Data</h3>
                <div class="example-grid">
                    <div class="example-item">
                        <img src="assets/images/analysis_1.png" alt="Phase Space Analysis" class="example-img">
                        <p>Phase space trajectory analysis</p>
                    </div>
                    <div class="example-item">
                        <img src="assets/images/analysis_2.png" alt="Time Series Analysis" class="example-img">
                        <p>Time series trajectory visualization</p>
                    </div>
                    <div class="example-item">
                        <img src="assets/images/analysis_3.png" alt="Combined Analysis" class="example-img">
                        <p>Combined multimodal analysis</p>
                    </div>
                </div>
            </div>

            <div class="dataset-download">
                <a href="#" class="btn btn-primary btn-large">
                    <i class="fas fa-download"></i> Download PhysSymbol Dataset
                </a>
                <p class="download-info">Dataset will be released upon paper acceptance</p>
            </div>
        </div>
    </section>

    <!-- Citation Section -->
    <section id="citation" class="section bg-light">
        <div class="container">
            <h2 class="section-title">Citation</h2>
            <div class="citation-box">
                <pre><code>
                    wait for me :-)
                </code></pre>
                <button class="copy-btn" onclick="copyBibTeX()">
                    <i class="fas fa-copy"></i> Copy BibTeX
                </button>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <h4>KDP-AD</h4>
                    <p>A Knowledge-Driven Diffusion Policy for End-to-End Autonomous Driving Based on Expert Routing.</p>
                </div>
                <div class="footer-section">
                    <h4>Resources</h4>
                    <ul>
                        <li><a href="#paper">Paper</a></li>
                        <li><a href="#dataset">Dataset</a></li>
                        <li><a href="#code">Code</a></li>
                    </ul>
                </div>
                <div class="footer-section">
                    <h4>Contact</h4>
                    <p>For questions about this work, please contact the authors.</p>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2025 KDP-AD. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <script src="assets/js/script.js"></script>
</body>
</html>